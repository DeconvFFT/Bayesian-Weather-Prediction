"0","X <- model.matrix(apparent_temperature ~ ., weather.df %>% dplyr::select(apparent_temperature,temperature,humidity,wind_speed))"
"0","n <- nrow(X)"
"0",""
"0","XtX.inv <- solve(t(X) %*% X)"
"0","H <- X %*% XtX.inv %*% t(X)"
"0","y <- weather.df$apparent_temperature"
"0","tmp_lm <-lm(y  ~ X + 0)"
"0","s20 <- summary(tmp_lm)$sigma^2"
"0","beta.ols <- XtX.inv %*% t(X) %*% weather.df$apparent_temperature"
"0","ssreg <- t(weather.df$apparent_temperature) %*% (diag(n) - g / (g + 1) * H ) %*% weather.df$apparent_temperature"
"0","trace <- list(s2 = numeric(nSamples), beta = array(NA, dim=c(nSamples,4)))"
"0",""
"0","# collect sigma^2 and beta"
"0","for (i in 1:nSamples){"
"0","  s2 <- 1/rgamma(n=1, shape = (nu0+n)/2, rate = (nu0*sigma20 + SSRg)/2)"
"0","  beta <- mvrnorm(n=1, mu = g/(g+1)*beta.ols, Sigma=g/(g+1) * s2 * XtX.inv)"
"0","  trace$s2[i] <- s2"
"0","  trace$beta[i,] <- beta"
"0","}"
