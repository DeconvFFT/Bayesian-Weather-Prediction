"0","X <- X [, c(2, 6,7,8)]"
"0","n <- nrow(X)"
"0","p <- ncol(X)"
"0","XtX.inv <- solve(t(X) %*% X)"
"0","H <- X %*% XtX.inv %*% t(X)"
"0","tmp_lm <-lm(y  ~ X + 0)"
"0","s20 <- summary(tmp_lm)$sigma^2"
"0","beta.ols <- XtX.inv %*% t(X) %*%y"
"0","ssreg <- t(y) %*% (diag(n) - g / (g + 1) * H ) %*% y"
"0","trace <- list(s2 = numeric(nSamples), beta = array(NA, dim=c(nSamples,p)))"
"0",""
"0","# collect sigma^2 and beta"
"0","for (i in 1:nSamples){"
"0","  s2 <- 1/rgamma(n=1, shape = (nu0+n)/2, rate = (nu0*sigma20 + SSRg)/2)"
"0","  beta <- mvrnorm(n=1, mu = g/(g+1)*beta.ols, Sigma=g/(g+1) * s2 * XtX.inv)"
"0","  trace$s2[i] <- s2"
"0","  trace$beta[i,] <- beta"
"0","}"
